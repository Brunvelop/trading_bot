import os
import sys
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from pathlib import Path

from definitions import PlotMode
from backtesting.backtester import Backtester
from strategies import TrendMomentumStrategy

if __name__ == "__main__":
    backtester = Backtester(
        strategy=TrendMomentumStrategy(),
        initial_balance_a=0.0,
        initial_balance_b=1000.0,  # Starting with 100k USDT
        fee=0.001,  # 0.1% fee
        verbose=False
    )
    
    df = backtester.run_backtest(
        data_config={
            'data_path': Path('E:/binance_prices_processed'),
            'duration': 4320,
            'variation': 0.01,
            'tolerance': 0.01,
            'normalize': True
        }
    )
    
    backtester.plot_results(
        plot_config={
            'plot_modes': list(PlotMode),
            'save_path': None,
            'show': True
        }
    )
